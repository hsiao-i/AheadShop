"use strict";(self["webpackChunkAheadShop"]=self["webpackChunkAheadShop"]||[]).push([[121],{121:function(t,e,a){a.r(e),a.d(e,{default:function(){return mt}});var s=a(6252),l=a(3577),o=a(9963);const i=t=>((0,s.dD)("data-v-52a04084"),t=t(),(0,s.Cn)(),t),r={class:"container"},n=(0,s.uE)('<div data-v-52a04084><div class="d-flex justify-content-between j mx-auto my-5 top-block" data-v-52a04084><div data-v-52a04084><div class="rounded-pill order-shape mb-1 position-relative mx-auto" data-v-52a04084><p class="position-absolute start-50 top-50 translate-middle" data-v-52a04084>1</p></div><p class="text-center fs-7" data-v-52a04084>填寫資料</p></div><div data-v-52a04084><div class="rounded-pill text-center order-shape-light mx-auto mb-1 position-relative" data-v-52a04084><p class="position-absolute start-50 top-50 translate-middle" data-v-52a04084>2</p></div><p class="text-center fs-7" data-v-52a04084>確認訂單</p></div><div data-v-52a04084><div class="rounded-pill text-center order-shape-light mx-auto mb-1 position-relative" data-v-52a04084><p class="position-absolute start-50 top-50 translate-middle" data-v-52a04084>3</p></div><p class="text-center fs-7" data-v-52a04084>購買完成</p></div></div></div>',1),d={class:"table-cus col-12 col-md-10 mx-auto"},c=i((()=>(0,s._)("h5",{class:"h5 bg-danger bg-gradient rounded-top p-3 text-white",style:{"--bs-bg-opacity":"0.5"}}," 購物車 ",-1))),u={key:0,class:"text-center p-5"},m=i((()=>(0,s._)("p",null,"購物車內沒有商品喔",-1))),p=i((()=>(0,s._)("button",{type:"button",class:"btn btn-danger w-25 text-white bg-gradient"}," 前往逛逛 ",-1))),h={key:1,class:"px-4"},f={class:"w-100 mt-4 table",ref:"table"},g=i((()=>(0,s._)("thead",{class:"thead"},[(0,s._)("tr",{class:"text-center"},[(0,s._)("th",{scope:"col",class:"py-3"},"商品資訊"),(0,s._)("th",{scope:"col",class:"py-3"},"單件價格 / 數量"),(0,s._)("th",{scope:"col",class:"py-3"},"小計"),(0,s._)("th",{scope:"col"})])],-1))),v={class:"border-bottom align-items-center"},_={class:"p-3","data-title":"商品資訊"},b={class:"d-md-flex d-block align-items-center"},w=["src","alt"],x={class:"mt-2 text-center"},C={class:"text-start"},y={key:0},$={key:1,class:"text-danger"},k=i((()=>(0,s._)("br",null,null,-1))),V={class:"text-secondary fs-7"},D={class:"d-flex justify-content-start align-items-center"},L=i((()=>(0,s._)("div",{class:"me-1"},[(0,s._)("label",{for:"qty"},"數量")],-1))),B=["onUpdate:modelValue","onChange"],U=["value"],W=["onClick"],q=i((()=>(0,s._)("i",{class:"bi bi-trash text-secondary fs-6"},null,-1))),z=[q],T={class:"row"},j={class:"col-12 col-md-6 mt-4"},A={class:"col-12 col-md-6"},N={class:"mt-4"},E={class:"d-flex"},I={class:"mt-3"},M={class:"d-flex justify-content-between"},O=i((()=>(0,s._)("p",null,"商品小計",-1))),S={class:"d-flex justify-content-between"},F=i((()=>(0,s._)("p",null,"折抵金額",-1))),H={class:"d-flex justify-content-between mt-3"},Y=i((()=>(0,s._)("p",null,"結帳金額",-1))),Z={class:"text-danger fs-5-5"},K={class:"table-cus my-5 col-12 col-md-10 mx-auto"},P=i((()=>(0,s._)("h5",{class:"h5 bg-danger bg-gradient rounded-top p-3 text-white",style:{"--bs-bg-opacity":"0.5"}}," 填寫顧客資訊 ",-1))),G={class:"p-4"},J={class:"mb-3"},Q=i((()=>(0,s._)("label",{for:"name",class:"form-label"},[(0,s.Uk)("姓名"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),R={class:"mb-3"},X=i((()=>(0,s._)("label",{for:"email",class:"form-label"},[(0,s.Uk)("Email"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),tt={class:"mb-3"},et=i((()=>(0,s._)("label",{for:"phone",class:"form-label"},[(0,s.Uk)("手機號碼"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),at={class:"mb-3"},st=i((()=>(0,s._)("label",{for:"address",class:"form-label"},[(0,s.Uk)("收件地址"),(0,s._)("span",{class:"text-danger fs-5-5 ms-1"},"*")],-1))),lt={class:"mb-3"},ot=i((()=>(0,s._)("label",{for:"message",class:"form-label"},"留言",-1))),it=["disabled"];function rt(t,e,a,i,q,rt){const nt=(0,s.up)("LoadingOverlay"),dt=(0,s.up)("router-link"),ct=(0,s.up)("VField"),ut=(0,s.up)("ErrorMessage"),mt=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(nt,{active:q.isLoading,"z-indes":1e3},null,8,["active"]),(0,s._)("div",r,[n,(0,s._)("div",d,[c,0===q.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",u,[m,(0,s.Wm)(dt,{to:"/products"},{default:(0,s.w5)((()=>[p])),_:1})])):((0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("table",f,[g,(0,s._)("tbody",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(q.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{class:"text-center",key:t.id},[(0,s._)("td",_,[(0,s._)("div",b,[(0,s._)("img",{src:t.product.imageUrl,alt:t.product.title,class:"cart-img me-3 rounded-3"},null,8,w),(0,s._)("h6",x,(0,l.zw)(t.product.title),1)])]),(0,s._)("td",C,[t.product.price===t.product.origin_price?((0,s.wg)(),(0,s.iD)("p",y," NT$ "+(0,l.zw)(t.product.price),1)):((0,s.wg)(),(0,s.iD)("p",$,[(0,s.Uk)(" NT$ "+(0,l.zw)(t.product.price)+" ",1),k,(0,s._)("del",V,"NT$ "+(0,l.zw)(t.product.origin_price),1)])),(0,s._)("div",D,[L,(0,s._)("div",null,[(0,s.wy)((0,s._)("select",{name:"qty",id:"qty",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>rt.changeCart(t)},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(e=>(0,s._)("option",{value:e,key:`${t.id} + ${e}`},(0,l.zw)(e),9,U))),64))],40,B),[[o.bM,t.qty]])])])]),(0,s._)("td",null,"NT$ "+(0,l.zw)(""+t.product.price*t.qty),1),(0,s._)("td",null,[(0,s._)("a",{href:"#",onClick:(0,o.iM)((e=>rt.deleteCart(t.id)),["prevent"])},z,8,W)])])))),128))])],512),(0,s._)("div",T,[(0,s._)("div",j,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[0]||(e[0]=(...t)=>rt.deleteAllCart&&rt.deleteAllCart(...t))}," 清空購物車 ")]),(0,s._)("div",A,[(0,s._)("div",N,[(0,s._)("div",E,[(0,s.Wm)(mt,{ref:"form",class:"w-100"},{default:(0,s.w5)((({errors:t})=>[(0,s.Wm)(ct,{id:"coupon",name:"優惠碼",type:"text",class:(0,l.C_)(["form-control rounded-0 rounded-start border-end-0",{"is-invalid":t["優惠碼"]}]),placeholder:"請輸入優惠碼",rules:"alpha_num",modelValue:q.coupon,"onUpdate:modelValue":e[1]||(e[1]=t=>q.coupon=t)},null,8,["class","modelValue"]),(0,s.Wm)(ut,{name:"優惠碼",class:"invalid-feedback"})])),_:1},512),(0,s._)("button",{type:"button",class:"btn btn-outline-danger text-button",onClick:e[2]||(e[2]=(...t)=>rt.useCoupon&&rt.useCoupon(...t))}," 使用優惠券 ")]),(0,s._)("div",I,[(0,s._)("div",M,[O,(0,s._)("p",null,"NT$ "+(0,l.zw)(q.cartData.total),1)]),(0,s._)("div",S,[F,(0,s._)("p",null," - NT$ "+(0,l.zw)(`${Math.ceil(q.cartData.total-q.cartData.final_total)}`),1)]),(0,s._)("div",H,[Y,(0,s._)("p",Z," NT$ "+(0,l.zw)(`${Math.ceil(q.cartData.final_total)}`),1)])])])])])]))]),(0,s._)("div",K,[P,(0,s._)("div",G,[(0,s.Wm)(mt,{ref:"form",onSubmit:rt.submitOrder},{default:(0,s.w5)((({errors:t})=>[(0,s._)("div",J,[Q,(0,s.Wm)(ct,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入收件人姓名",rules:"required",modelValue:q.form.user.name,"onUpdate:modelValue":e[3]||(e[3]=t=>q.form.user.name=t)},null,8,["class","modelValue"]),(0,s.Wm)(ut,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",R,[X,(0,s.Wm)(ct,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:q.form.user.email,"onUpdate:modelValue":e[4]||(e[4]=t=>q.form.user.email=t)},null,8,["class","modelValue"]),(0,s.Wm)(ut,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",tt,[et,(0,s.Wm)(ct,{id:"phone",name:"手機號碼",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":t["手機號碼"]}]),placeholder:"請輸入手機號碼",rules:rt.isPhone,modelValue:q.form.user.tel,"onUpdate:modelValue":e[5]||(e[5]=t=>q.form.user.tel=t)},null,8,["class","rules","modelValue"]),(0,s.Wm)(ut,{name:"手機號碼",class:"invalid-feedback"})]),(0,s._)("div",at,[st,(0,s.Wm)(ct,{id:"address",name:"收件地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":t["收件地址"]}]),placeholder:"請輸入收件地址",rules:"required",modelValue:q.form.user.address,"onUpdate:modelValue":e[6]||(e[6]=t=>q.form.user.address=t)},null,8,["class","modelValue"]),(0,s.Wm)(ut,{name:"收件地址",class:"invalid-feedback"})]),(0,s._)("div",lt,[ot,(0,s.wy)((0,s._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[7]||(e[7]=t=>q.form.message=t)},null,512),[[o.nr,q.form.message]])]),(0,s._)("button",{type:"submit",class:"btn btn-danger w-100",disabled:0===q.cartData.carts.length||Object.keys(t).length>0}," 確認訂單 ",8,it)])),_:1},8,["onSubmit"])])])])],64)}var nt=a(4902),dt={emits:["emit-order"],data(){return{cartData:{carts:[]},coupon:"",isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""},pay:"default",orderId:""}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cartData=t.data.data,this.isLoading=!1})).catch((t=>{this.$swal.fire({icon:"warning",text:t.response.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1}))},useCoupon(){const t="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/coupon",e={code:this.coupon};this.$http.post(t,{data:e}).then((t=>{this.$swal.fire({icon:"success",text:t.data.message,showConfirmButton:!1,timer:1800}),this.getCart()}))},changeCart(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart/${t.id}`,a={product_id:t.product.id,qty:t.qty};this.$http.put(e,{data:a}).then((t=>{this.$swal.fire({icon:"success",text:t.data.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1})).catch((t=>{this.$swal.fire({icon:"warning",text:t.response.data.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1}))},deleteCart(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/hsiaoi/cart/${t}`;this.$http.delete(e).then((t=>{this.$swal.fire({icon:"success",text:t.data.message,showConfirmButton:!1,timer:1800}),this.getCart(),nt.Z.emit("get-cart"),this.isLoading=!1})).catch((t=>{this.$swal.fire({icon:"warning",text:t.response.data.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1}))},deleteAllCart(){const t="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/carts";this.$http.delete(t).then((t=>{this.$swal.fire({text:"是否確認清空購物車？",icon:"warning",showCancelButton:!0,confirmButtonColor:"#E3CACA",cancelButtonColor:"#C18787",confirmButtonText:"清空購物車"}).then((t=>{t.isConfirmed&&this.$swal.fire({text:"確認清空購物車～",icon:"success",confirmButtonColor:"#C18787"})})),this.getCart(),nt.Z.emit("get-cart")})).catch((t=>{this.$swal.fire({icon:"warning",text:t.response.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1}))},submitOrder(){const t="https://vue3-course-api.hexschool.io/v2/api/hsiaoi/order";this.isLoading=!0;const e=this.form;this.$http.post(t,{data:e}).then((t=>{this.$swal.fire({icon:"success",text:"成功送出資料 ✿",showConfirmButton:!1,timer:1800}),this.$refs.form.resetForm(),this.isLoading=!1,this.orderId=t.data.orderId,this.$router.push(`/order/${this.orderId}`)})).catch((t=>{this.$swal.fire({icon:"error",text:t.response.data.message,showConfirmButton:!1,timer:1800}),this.isLoading=!1}))},isPhone(t){if(!t)return"手機號碼 為必填";const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的手機號碼"}},watch:{$route(){this.getCart(),console.log(this.$route.name)}},mounted(){this.getCart()}},ct=a(3744);const ut=(0,ct.Z)(dt,[["render",rt],["__scopeId","data-v-52a04084"]]);var mt=ut}}]);
//# sourceMappingURL=121.55008006.js.map